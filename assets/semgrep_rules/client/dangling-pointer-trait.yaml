rules:
  - id: dangling-pointer-trait
    metadata:
      author: Artem Chaikin
      references:
        - https://chromium.googlesource.com/chromium/src.git/+/main/docs/dangling_ptr.md
      source: https://github.com/brave/security-action/blob/main/assets/semgrep_rules/client/dangling-pointer-trait.yaml
      assignees: |
        stoletheminerals
        thypon
        cdesouza-chromium
    pattern-regex: \braw_(ptr|ref)<[^,>]+,\s*(DanglingUntriaged|DisableDanglingPtrDetection|FlakyDanglingUntriaged|AcrossTasksDanglingUntriaged|AllowPtrArithmetic|AllowUninitialized|LeakedDanglingUntriaged|VectorExperimental|SetExperimental|CtnExperimental)\b\s*>
    message: "Detected use of a trait that disables dangling pointer checks. This requires security team approval."
    severity: WARNING
    languages:
      - cpp
